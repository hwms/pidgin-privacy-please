diff -Naur pidgin-2.4.1.orig/libpurple/conversation.c pidgin-2.4.1/libpurple/conversation.c
--- pidgin-2.4.1.orig/libpurple/conversation.c	2008-03-31 19:21:23.000000000 +0200
+++ pidgin-2.4.1/libpurple/conversation.c	2008-04-03 00:35:55.081206555 +0200
@@ -2208,6 +2208,13 @@
 										PURPLE_SUBTYPE_CONVERSATION),
 						 purple_value_new(PURPLE_TYPE_UINT));
 
+	purple_signal_register(handle, "blocked-im-msg",
+						 purple_marshal_VOID__POINTER_POINTER,
+						 NULL, 2,
+						 purple_value_new(PURPLE_TYPE_SUBTYPE,
+										PURPLE_SUBTYPE_ACCOUNT),
+						 purple_value_new_outgoing(PURPLE_TYPE_STRING));
+
 	purple_signal_register(handle, "writing-chat-msg",
 						 purple_marshal_BOOLEAN__POINTER_POINTER_POINTER_POINTER_UINT,
 						 purple_value_new(PURPLE_TYPE_BOOLEAN), 5,
diff -Naur pidgin-2.4.1.orig/libpurple/server.c pidgin-2.4.1/libpurple/server.c
--- pidgin-2.4.1.orig/libpurple/server.c	2008-03-31 19:21:24.000000000 +0200
+++ pidgin-2.4.1/libpurple/server.c	2008-04-03 00:35:55.101247632 +0200
@@ -659,8 +659,11 @@
 
 	if (PURPLE_PLUGIN_PROTOCOL_INFO(purple_connection_get_prpl(gc))->set_permit_deny == NULL) {
 		/* protocol does not support privacy, handle it ourselves */
-		if (!purple_privacy_check(account, who))
+		if (!purple_privacy_check(account, who)) {
+			purple_signal_emit(purple_conversations_get_handle(),
+					"blocked-im-msg", account, &who);
 			return;
+		}
 	}
 
 	/*
@@ -879,8 +882,11 @@
 	account = purple_connection_get_account(gc);
 	if (PURPLE_PLUGIN_PROTOCOL_INFO(purple_connection_get_prpl(gc))->set_permit_deny == NULL) {
 		/* protocol does not support privacy, handle it ourselves */
-		if (!purple_privacy_check(account, who))
+		if (!purple_privacy_check(account, who)) {
+			purple_signal_emit(purple_conversations_get_handle(),
+					"blocked-im-msg", account, &who);
 			return;
+		}
 	}
 
 	plugin_return = GPOINTER_TO_INT(purple_signal_emit_return_1(
